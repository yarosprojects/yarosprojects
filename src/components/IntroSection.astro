---
import FRAMEWORKS from '@consts/frameworks';
import LANGUAGES from '@consts/languages';
import { imageConfig } from "astro:assets";
import avatar from "../../public/img/avatar.png";
import locations from '@consts/locations';

const { creador, translate, locale } = Astro.props;
const cfgs_started_at = 2022;
---
<div
    class="flex justify-start pt-15 md:pt-30 items-center flex-col min-h-screen w-full relative z-10"
>
    <div
        class="py-5 md:w-2xl w-full flex flex-col md:flex-row justify-start items-start"
    >
        <img
            src={avatar.src}
            alt="Avatar Yaroslav Klymko"
            class="w-40 mx-auto md:mx-0 h-auto rounded-full animate-fade-in-down mask-avatar"
        />
        <div
            class="flex flex-1 p-4 md:px-8 md:py-15 flex-col items-center md:items-start justify-start w-full h-full"
        >
            <span
                class="dark:text-white text-black text-center md:text-left text-3xl font-extrabold animate-fade-in animate-duration-50"
            >
                {creador}
            </span>
            <div class="my-2 h-px rounded-full w-xs md:w-full dark:bg-white/80 bg-black/80">
            </div>
            <div
                class="flex m-0 p-0 justify-center md:justify-start w-full overflow-hidden"
            >
                <span
                    class="dark:text-yellow-400 text-yellow-600 font-bold animate-fade-in-up animate-duration-800 animate-delay-250 max-[195px]:text-base text-xl selection:bg-transparent
                    selection:backdrop-blur-3xl selection:text-white/70 text-center md:text-left"
                >
                    {translate.intro.fullstack_web_developer}
                </span>
            </div>
            <div class="flex flex-col w-full text-sm pt-5 pb-3 md:py-3">
                <a
                    href="https://www.linkedin.com/in/yaroslav-klymko-psip"
                    target="_blank"
                    rel="noopener"
                    class="px-3 py-2 md:py-1 text-[15px] md:text-sm dark:bg-gray-800 bg-green-300/50 dark:hover:bg-gray-700 hover:bg-green-300/50 transition-all hover:scale-105 rounded-full shadow-md dark:shadow-green-300/25 w-fit md:mx-0 mx-auto dark:text-green-300 text-green-700 border dark:border-green-300/20 border-green-500"
                    aria-label="Enlace a LinkedIn"
                >
                    #OpenToWork
                </a>
            </div>
        </div>
    </div>
    <div class="w-full flex justify-center items-center">
        <div
            class="text-white flex max-[400px]:flex-col flex-row w-full justify-center items-center text-center text-3xl"
        >
            <div class="flex flex-row w-fit pb-0 max-[400px]:pb-4">
                <p class="scale-120 text-blue-700">+</p>
                <div
                    class="text-blue-700 scale-170 px-3 font-extrabold rotate-10 animate-swing-drop-in"
                >
                    {new Date().getFullYear() - cfgs_started_at}
                </div>
            </div>
            <div class="flex flex-col px-2">
                <p class="dark:text-yellow-50 text-yellow-500 font-bold uppercase text-2xl">{translate.intro.years_of_experience}</p>
                <span class="dark:text-white/75 text-black/75 dark:text-sm text-base">
                    {translate.intro.work_plus_personal_experience}
                </span>
            </div>
        </div>
    </div>
    <div class="w-full flex justify-center items-center py-15">
        <div class="flex flex-col justify-start items-center md:items-start w-full">
            {/*
            <div class="w-full flex justify-center md:justify-start h-auto md:h-10 items-start flex-row overflow-hidden m-0 p-0">
                <div class="hidden md:flex w-1 h-full animate-h-full bg-white rounded-full mr-2"></div>
                <h2 class="text-white animate-none md:animate-translate-x-delay-500 translate-x-0 invisible text-4xl items-center justify-start flex flex-col md:flex-row font-black tracking-wider text-center md:text-left" id="greetings_iam">
                    <span class="text-white/70 italic">{translate.intro.hello_iam}</span> 
                    <span class="block md:inline-block mt-1.5 md:mt-0 mx-3">
                        {translate.creator_name},
                    </span>
                </h2>
            </div>
            */}
            {/* <div class="flex md:hidden w-1/2 h-0.5 bg-white rounded-full mt-5"></div> */}
            <div class="w-full flex flex-col p-0 md:p-2 md:w-3xl mx-0 md:mx-auto px-4 md:px-0">
                <p class="dark:text-white/70 text-black/70 max-[195px]:text-base text-xl text-center md:text-left mt-20 mb-5 selection:bg-yellow-500 selection:text-black">
                    <span class="dark:text-yellow-300 text-yellow-500 font-extrabold">
                        {locale === "en-GB" ? translate.intro.web_applications.charAt(0).toUpperCase() + translate.intro.web_applications.slice(1) : translate.intro.developer}
                        { (locale === "es-ES" || locale === "ca-ES") && (
                            <span class="dark:text-white/70 text-black/70 font-normal">{locale === "ca-ES" ? 'dels' : 'de'}</span>
                        ) }
                        {locale === "en-GB" ? translate.intro.developer.toLowerCase() : translate.intro.web_applications}
                    </span>
                    {translate.intro.bioinformatical_profile}
                    <span class="dark:text-yellow-100 text-yellow-500 relative before:absolute before:content-[''] before:left-0 before:top-full before:w-0 before:h-px dark:before:bg-yellow-100 before:bg-yellow-500 before:animate-width-to-full">
                        {translate.intro.bioinformatical}
                    </span>
                    <br>
                    {translate.intro.from} 
                    <a href={locations(locale).psip.location} target="_blank" class="dark:hover:text-white hover:text-black inline-block backdrop-blur-3xl hover:px-2 dark:hover:bg-transparent hover:bg-gray-900/10 hover:scale-105 transition-all mt-1">{locations(locale).psip.name}</a>, {locations(locale).spain.name}.
                    <br>
                </p>
                <p class="dark:text-white/70 text-black/70 max-[195px]:text-base text-xl text-center md:text-left selection:bg-yellow-500 selection:text-black mt-8 md:mb-0 mb-5 md:mt-0">
                    {translate.intro.focused_on} <span class="dark:text-yellow-100 text-yellow-500">{translate.intro.creation}</span>, <span class="dark:text-yellow-100 text-yellow-500">{translate.intro.maintenance}</span> {translate.intro.and} <span class="dark:text-yellow-100 text-yellow-500">{translate.intro.resolution}</span> {translate.intro.of_the} <span class="dark:text-yellow-100 text-yellow-500">{translate.intro.vulnerability}</span> {translate.intro.of_normal} {translate.intro.of_static_and_dynamic_web_pages} <span class="dark:text-yellow-100 text-yellow-500">{translate.intro.statics}</span> {translate.intro.and_normal} <span class="dark:text-yellow-100 text-yellow-500">{translate.intro.dynamics}</span> 
                    {translate.intro.websites}
                    .
                </p>
            </div>
            <div class="flex flex-col gap-15 md:gap-3 w-full">
                <div class="flex flex-col w-full gap-7 md:w-3xl mx-0 md:mx-auto px-4 md:px-0" aria-label="Contenedor de frameworks">
                    <div
                        id="frameworks-container" 
                        class="relative w-full flex justify-center md:justify-start items-center flex-wrap flex-row gap-2 overflow-hidden md:overflow-auto max-h-17 md:max-h-full transition-all duration-500 px-0 py-11"
                    >
                        {
                            FRAMEWORKS.map((framework) => {
                                const { name, animation_delay, img } = framework;
                                return (
                                    <div class="flex flex-row justify-center items-center gap-2 px-5 m-1 md:px-4 py-2 md:py-2 rounded-full dark:bg-gray-800 bg-gray-100 animate-fade-in framework-card dark:drop-shadow-none drop-shadow-sm drop-shadow-black/50 my-3"
                                        style={`animation-delay: ${animation_delay}ms;`}
                                    >
                                        <img src={img} alt={`Image of ${name}`} class={`size-5 ${name.toLowerCase() === "java" ? '-translate-y-0.75' : ''}`} />
                                        <span class="dark:text-white text-black">
                                            {name}
                                        </span>
                                    </div>
                                )
                            })
                        }

                        <div class="absolute flex md:hidden left-0 -bottom-1 w-full h-10 bg-linear-to-t from-(--primary-color) to-transparent pointer-events-none opacity-100 transition-opacity" id="frameworks-overlay"></div>
                    </div>
                    <div class="w-full flex md:hidden justify-center items-center max-[195px]:px-0 px-4 py-5">
                        <button
                            id="show-frameworks-more"
                            type="button"
                            class="px-4 py-2 rounded-lg max-[195px]:w-full w-fit text-black bg-yellow-500 font-extrabold cursor-pointer outline-none border-none max-[195px]:text-sm text-base"
                            data-showMore={translate.intro.show_more}
                            data-showLess={translate.intro.show_less}
                            aria-label="Boton de mostrar más y mostrar menos los frameworks de programación"
                        >
                            {translate.intro.show_more}
                        </button>
                    </div>
                </div>
                <div class="flex flex-col w-full gap-7 pt-7" aria-label="Contenedor de lenguajes de programación">
                    <div
                        id="languages-container" 
                        class="flex flex-col w-full"
                    >
                        <div class="w-full mx-auto max-w-3xl grid grid-cols-2 max-[680px]:grid-cols-1 gap-20 md:gap-8">
                            {
                                Object.entries(LANGUAGES).map(([category, categoryName], index) => {
                                    const { id, name, content } = categoryName;
                                    return (
                                        <div class="language-card w-full flex flex-col justify-center items-center md:px-0 px-2" id={`${id}-container`}>
                                            <div class="w-full flex justify-center items-center py-3" aria-label="Languages title">
                                                <h2 class="dark:text-yellow-200 text-blue-700 dark:font-normal font-bold md:text-3xl text-2xl">
                                                    {name}
                                                </h2>
                                            </div>
                                            <div class="language-content relative max-[680px]:min-h-fit min-h-100 h-full dark:grayscale-50 grayscale-0 md:shadow-none shadow-md dark:bg-transparent bg-transparent md:bg-gray-100/80 pb-16 max-w-96 rounded-2xl w-full items-start grid grid-cols-3 max-[415px]:grid-cols-2 max-[415px]:gap-8 justify-center max-[270px]:gap-12 gap-x-3 gap-y-12 overflow-hidden pt-10 px-3 max-[270px]:flex max-[270px]:flex-col md:border-none border dark:border-yellow-100/50 animate-border-reflect md:animate-border-reflect-none">
                                                <div class="borde absolute md:block hidden"></div>
                                                <div class="borde absolute md:block hidden"></div>
                                                <div class="borde absolute md:block hidden"></div>
                                                <div class="borde absolute md:block hidden"></div>
                                                {
                                                    Object.values(content).map(language => {
                                                        const { id, name, img } = language;
                                                        return (
                                                            <div class="w-full flex flex-col justify-center items-center px-4">
                                                                <img src={img} alt={`${id}-image`} class="max-[270px]:size-25 max-[415px]:size-20 size-15 object-contain" />
                                                                <span class="dark:text-white text-black mt-2">
                                                                    {name}
                                                                </span>
                                                            </div>
                                                        )
                                                    })
                                                }
                                            </div>
                                        </div>
                                    )
                                })
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script is:inline>
    document.addEventListener('DOMContentLoaded', function() {
        const $showMorFrameworksBtn = document.getElementById('show-frameworks-more');
        const $framweworksContainer = document.getElementById('frameworks-container');
        const $languagesContainer = document.getElementById('languages-container');
        const $language_cards = $languagesContainer.querySelectorAll('.language-card');
        const $frameworksOverlay = document.getElementById('frameworks-overlay');
        const $frameworksCards = $framweworksContainer.querySelectorAll('.framework-card');

        // FRAMEWORKS
        let frameworksShowed = false;
        $showMorFrameworksBtn?.addEventListener('click', function() {
            let num_first_frameworks = setFirstFrameworks();
            frameworksShowed = !frameworksShowed
            
            if(frameworksShowed) {
                $frameworksOverlay.classList.remove('opacity-100');
                $frameworksOverlay.classList.add('opacity-0');
                $framweworksContainer?.classList.remove('max-h-17');
                $framweworksContainer?.classList.add('max-h-100');
                $showMorFrameworksBtn.innerHTML = $showMorFrameworksBtn.getAttribute('data-showLess');
                $frameworksCards.forEach((card, index) => {
                    if(index >= num_first_frameworks){
                        card.classList.remove('animate-fade-in');
                        void card.offsetWidth;
                        card.classList.add('animate-fade-in');
                    }
                });
            } else {
                $framweworksContainer?.classList.remove('max-h-100');
                $framweworksContainer?.classList.add('max-h-17');
                setTimeout(function() {
                    $frameworksOverlay.classList.remove('opacity-0');
                    $frameworksOverlay.classList.add('opacity-100');
                    $showMorFrameworksBtn.innerHTML = $showMorFrameworksBtn.getAttribute('data-showMore');
                }, 150);
            }
        });


        // PROGRAMMING LANGUAGES
        
        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if(entry.isIntersecting) {
                    entry.target.classList.add('animate-fade-in-up');
                    observer.unobserve(entry.target);
                } 
            })
        });

        $language_cards.forEach(card => {
            observer.observe(card);
        })


        function setFirstFrameworks() {
            if(window.innerWidth > 286 && window.innerWidth <= 419) return 2;
            if(window.innerWidth > 419 && window.innerWidth <= 553) return 3;
            if(window.innerWidth > 553 && window.innerWidth <= 672) return 4; 
            if(window.innerWidth > 672) return 5; 

            return 1;
        }
    });
</script>

<style>
    html.dark .mask-avatar {
        -webkit-mask-image: radial-gradient(circle, rgba(255,255,255,1) 30%, rgba(0,0,0,0) 100%);
        mask-image: radial-gradient(circle, rgba(255,255,255,1) 40%, rgba(0,0,0,0) 65%);
    }
    .mask-avatar {
        border-radius: 50%;
        -webkit-mask-image: radial-gradient(circle, rgba(0,0,0,1) 30%, rgba(0,0,0,0) 100%);
        mask-image: radial-gradient(circle, rgba(0,0,0,1) 40%, rgba(0,0,0,0) 70%);
        -webkit-mask-repeat: no-repeat;
        mask-repeat: no-repeat;
        -webkit-mask-position: center;
        mask-position: center;
        -webkit-mask-size: cover;
        mask-size: cover;
        animation: invertShow 1s forwards;
    }

    /* Top */
    .language-content .borde:nth-child(1) {
        top: 0;
        left: -100%;
        width: 100%;
        height: 1px;
        background: linear-gradient(90deg, transparent, yellow);
        animation: borderTop 5s linear infinite;
    }

    /* Right */
    .language-content .borde:nth-child(2) {
        top: -100%;
        right: 0;
        width: 1px;
        height: 100%;
        background: linear-gradient(180deg, transparent, blue);
        animation: borderRight 5s linear infinite;
        animation-delay: 2.5s;
    }

    /* Bottom */
    .language-content .borde:nth-child(3) {
        bottom: 0;
        right: -100%;
        width: 100%;
        height: 1px;
        background: linear-gradient(270deg, transparent, yellow);
        animation: borderBottom 5s linear infinite;
        animation-delay: 5s;
    }

    /* Left */
    .language-content .borde:nth-child(4) {
        bottom: -100%;
        left: 0;
        width: 1px;
        height: 100%;
        background: linear-gradient(0deg, transparent, blue);
        animation: borderLeft 5s linear infinite;
        animation-delay: 7.5s;
    }

    @keyframes borderTop {
        0%   { left: -100%; }
        100% { left: 100%; }
    }

    @keyframes borderRight {
        0%   { top: -100%; }
        100% { top: 100%; }
    }

    @keyframes borderBottom {
        0%   { right: -100%; }
        100% { right: 100%; }
    }

    @keyframes borderLeft {
        0%   { bottom: -100%; }
        100% { bottom: 100%; }
    }


    @keyframes invertShow {
        from {
            filter: invert(.3);
        } to {
            filter: invert(0);
        }
    }
</style>